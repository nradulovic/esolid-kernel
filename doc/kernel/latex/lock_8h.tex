\hypertarget{lock_8h}{\subsection{lock.\-h File Reference}
\label{lock_8h}\index{lock.\-h@{lock.\-h}}
}


Critical code and kernel lock management.  


{\ttfamily \#include \char`\"{}arch/cpu.\-h\char`\"{}}\\*
Include dependency graph for lock.\-h\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{lock_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\-:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=130pt]{lock_8h__dep__incl}
\end{center}
\end{figure}
\subsubsection*{Macros}
\begin{Indent}{\bf Critical code management}\par
{\em Disable/enable interrupts by preserving the interrupt context

Generally speaking these macros would store the interrupt context in the local variable of port\-Reg\-\_\-\-T type and then disable interrupts. Local variable is allocated in all of e\-Solid-\/\-Kernel functions that need to disable interrupts. Macros would restore the interrupt context by copying back the allocated variable into the interrupt controller status/control register. }\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{lock_8h_aa9972fcda9f8dc8065bcef93ef45f3fa}{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R}(int\-Ctx)~\hyperlink{group__template__cpu__intf_ga85a60a2367e9911a383e1c6fe58b4e2c}{P\-O\-R\-T\-\_\-\-I\-N\-T\-\_\-\-P\-R\-I\-O\-\_\-\-R\-E\-P\-L\-A\-C\-E}(int\-Ctx, \hyperlink{group__template__cpu__intf_ga54bd14c990686d81c1e06bcd1791a8d7}{P\-O\-R\-T\-\_\-\-D\-E\-F\-\_\-\-M\-A\-X\-\_\-\-I\-S\-R\-\_\-\-P\-R\-I\-O})
\begin{DoxyCompactList}\small\item\em Enter critical code section. \end{DoxyCompactList}\item 
\#define \hyperlink{lock_8h_a1482c1e60e7eca4c8f6a6a711227e52e}{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T}(int\-Ctx)~\hyperlink{group__template__cpu__intf_gaef714a3cbef7493876ce0db1ca3b7752}{P\-O\-R\-T\-\_\-\-I\-N\-T\-\_\-\-P\-R\-I\-O\-\_\-\-S\-E\-T}(int\-Ctx)
\begin{DoxyCompactList}\small\item\em Exit critical code section. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\subsubsection*{Typedefs}
\begin{Indent}{\bf Critical code section locking management}\par
\begin{DoxyCompactItemize}
\item 
typedef \hyperlink{group__template__cpu__intf_ga99980ab56ce9857e7380210d12e3d41f}{port\-Reg\-\_\-\-T} \hyperlink{lock_8h_ad8b2b8257c3bf42c064adb66c0d45e2e}{es\-Lock\-Ctx\-\_\-\-T}
\begin{DoxyCompactList}\small\item\em Kernel lock context type. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}
\subsubsection*{Functions}
\begin{Indent}{\bf Multi-\/threading locking management}\par
{\em These methods are often used to protect concurrent access to a protected resource.

For more details see \hyperlink{critical_section}{Critical sections}. }\begin{DoxyCompactItemize}
\item 
void \hyperlink{group__kern__impl_gaa3ca4a02fafcfb840442506f42175a13}{es\-Kern\-Lock\-Int\-Enter} (\hyperlink{lock_8h_ad8b2b8257c3bf42c064adb66c0d45e2e}{es\-Lock\-Ctx\-\_\-\-T} $\ast$lock\-Ctx)
\begin{DoxyCompactList}\small\item\em Enter a critical code lock. \end{DoxyCompactList}\item 
void \hyperlink{group__kern__impl_gad8cb192a48802804cc12162edd18668d}{es\-Kern\-Lock\-Int\-Exit} (\hyperlink{lock_8h_ad8b2b8257c3bf42c064adb66c0d45e2e}{es\-Lock\-Ctx\-\_\-\-T} lock\-Ctx)
\begin{DoxyCompactList}\small\item\em Exit a critical code lock. \end{DoxyCompactList}\item 
void \hyperlink{group__kern__impl_ga6dd45355c20a10f7272bd39670353428}{es\-Kern\-Lock\-Enter\-I} (void)
\begin{DoxyCompactList}\small\item\em Lock the scheduler. \end{DoxyCompactList}\item 
void \hyperlink{group__kern__impl_ga3287aefb2c7dd24672c716d86a008ad3}{es\-Kern\-Lock\-Exit\-I} (void)
\begin{DoxyCompactList}\small\item\em Unlock the scheduler. \end{DoxyCompactList}\item 
void \hyperlink{group__kern__impl_ga86ec4f4cbaa889b0f23c7e2ebdcbbb97}{es\-Kern\-Lock\-Enter} (void)
\begin{DoxyCompactList}\small\item\em Lock the scheduler. \end{DoxyCompactList}\item 
void \hyperlink{group__kern__impl_gaf1eec663f7cc5c414b113901382ccd82}{es\-Kern\-Lock\-Exit} (void)
\begin{DoxyCompactList}\small\item\em Unlock the scheduler. \end{DoxyCompactList}\end{DoxyCompactItemize}
\end{Indent}


\subsubsection{Detailed Description}
Critical code and kernel lock management. \begin{DoxyAuthor}{Author}
Nenad Radulovic 
\end{DoxyAuthor}


\subsubsection{Macro Definition Documentation}
\hypertarget{lock_8h_aa9972fcda9f8dc8065bcef93ef45f3fa}{\index{lock.\-h@{lock.\-h}!E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R@{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R}}
\index{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R@{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R}!lock.h@{lock.\-h}}
\paragraph[{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-N\-T\-E\-R(
\begin{DoxyParamCaption}
\item[{}]{int\-Ctx}
\end{DoxyParamCaption}
)~{\bf P\-O\-R\-T\-\_\-\-I\-N\-T\-\_\-\-P\-R\-I\-O\-\_\-\-R\-E\-P\-L\-A\-C\-E}(int\-Ctx, {\bf P\-O\-R\-T\-\_\-\-D\-E\-F\-\_\-\-M\-A\-X\-\_\-\-I\-S\-R\-\_\-\-P\-R\-I\-O})}}\label{lock_8h_aa9972fcda9f8dc8065bcef93ef45f3fa}


Enter critical code section. 


\begin{DoxyParams}{Parameters}
{\em int\-Ctx} & Interrupt context, pointer to portable type variable which will hold the interrupt context state during the critical code section. \\
\hline
\end{DoxyParams}
\hypertarget{lock_8h_a1482c1e60e7eca4c8f6a6a711227e52e}{\index{lock.\-h@{lock.\-h}!E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T@{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T}}
\index{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T@{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T}!lock.h@{lock.\-h}}
\paragraph[{E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T}]{\setlength{\rightskip}{0pt plus 5cm}\#define E\-S\-\_\-\-C\-R\-I\-T\-I\-C\-A\-L\-\_\-\-L\-O\-C\-K\-\_\-\-E\-X\-I\-T(
\begin{DoxyParamCaption}
\item[{}]{int\-Ctx}
\end{DoxyParamCaption}
)~{\bf P\-O\-R\-T\-\_\-\-I\-N\-T\-\_\-\-P\-R\-I\-O\-\_\-\-S\-E\-T}(int\-Ctx)}}\label{lock_8h_a1482c1e60e7eca4c8f6a6a711227e52e}


Exit critical code section. 


\begin{DoxyParams}{Parameters}
{\em int\-Ctx} & Interrupt context, portable type variable which is holding a previously saved interrupt context state. \\
\hline
\end{DoxyParams}


\subsubsection{Typedef Documentation}
\hypertarget{lock_8h_ad8b2b8257c3bf42c064adb66c0d45e2e}{\index{lock.\-h@{lock.\-h}!es\-Lock\-Ctx\-\_\-\-T@{es\-Lock\-Ctx\-\_\-\-T}}
\index{es\-Lock\-Ctx\-\_\-\-T@{es\-Lock\-Ctx\-\_\-\-T}!lock.h@{lock.\-h}}
\paragraph[{es\-Lock\-Ctx\-\_\-\-T}]{\setlength{\rightskip}{0pt plus 5cm}typedef {\bf port\-Reg\-\_\-\-T} {\bf es\-Lock\-Ctx\-\_\-\-T}}}\label{lock_8h_ad8b2b8257c3bf42c064adb66c0d45e2e}


Kernel lock context type. 

Variables declared using this type can hold current lock context which can be restored after a critical code section is exited. 