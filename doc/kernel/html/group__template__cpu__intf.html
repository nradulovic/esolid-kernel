<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.5"/>
<title>eSolid - Real-Time Kernel: CPU port interface</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="eSolid-logo_small.png"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">eSolid - Real-Time Kernel
   &#160;<span id="projectnumber">1.0BetaR02</span>
   </div>
   <div id="projectbrief">Event Based System</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.5 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__template__cpu__intf.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Groups</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">CPU port interface<div class="ingroups"><a class="el" href="group__template.html">Port template</a></div></div>  </div>
</div><!--header-->
<div class="contents">

<p>CPU port macros and functions.  
<a href="#details">More...</a></p>
<div class="dynheader">
Collaboration diagram for CPU port interface:</div>
<div class="dyncontent">
<center><table><tr><td><img src="group__template__cpu__intf.png" border="0" alt="" usemap="#group____template____cpu____intf"/>
<map name="group____template____cpu____intf" id="group____template____cpu____intf">
<area shape="rect" id="node1" href="group__template.html" title="Templates. " alt="" coords="6,5,106,32"/></map>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structportStck.html">portStck</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack structure used for stack declaration in order to force the alignment Alignment of stack structure.  <a href="structportStck.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structportCtx.html">portCtx</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port context structure.  <a href="structportCtx.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:ga13cc91970e3e05fe4210440c068d3f4a"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structportStck.html">portStck</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga13cc91970e3e05fe4210440c068d3f4a">portStck_T</a></td></tr>
<tr class="memdesc:ga13cc91970e3e05fe4210440c068d3f4a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Stack type.  <a href="#ga13cc91970e3e05fe4210440c068d3f4a">More...</a><br/></td></tr>
<tr class="separator:ga13cc91970e3e05fe4210440c068d3f4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:gab0ad3c664e66a9a334daa4109c14e585"><td class="memItemLeft" align="right" valign="top">portReg_T&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">PortIsrNesting</a></td></tr>
<tr class="memdesc:gab0ad3c664e66a9a334daa4109c14e585"><td class="mdescLeft">&#160;</td><td class="mdescRight">Variable to keep track of ISR nesting.  <a href="#gab0ad3c664e66a9a334daa4109c14e585">More...</a><br/></td></tr>
<tr class="separator:gab0ad3c664e66a9a334daa4109c14e585"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Port constants</h2></td></tr>
<tr class="memitem:ga5a629fee11006b5b0b97f7cb7176efd4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga5a629fee11006b5b0b97f7cb7176efd4">PORT_DEF_STCK_MINSIZE</a>&#160;&#160;&#160;(sizeof(struct <a class="el" href="structportCtx.html">portCtx</a>) / sizeof(portReg_T))</td></tr>
<tr class="memdesc:ga5a629fee11006b5b0b97f7cb7176efd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">This macro specifies the minimal size of the thread stack.  <a href="#ga5a629fee11006b5b0b97f7cb7176efd4">More...</a><br/></td></tr>
<tr class="separator:ga5a629fee11006b5b0b97f7cb7176efd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
System timer constants</h2></td></tr>
<tr class="memitem:ga96e15dd16b285b0feb6e225b0834ad10"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga96e15dd16b285b0feb6e225b0834ad10">PORT_DEF_SYSTMR_WAKEUP_TH_VAL</a>&#160;&#160;&#160;600u</td></tr>
<tr class="memdesc:ga96e15dd16b285b0feb6e225b0834ad10"><td class="mdescLeft">&#160;</td><td class="mdescRight">Threshold system timer value for new tick.  <a href="#ga96e15dd16b285b0feb6e225b0834ad10">More...</a><br/></td></tr>
<tr class="separator:ga96e15dd16b285b0feb6e225b0834ad10"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Kernel threads port dependent settings</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp0e6f87e4f5cc0437b98e154b3e410859"></a>Kernel uses several threads for system management. This section defines port dependent settings for the threads. </p>
</td></tr>
<tr class="memitem:gabaa296d76c28043a60531ad8ed81504b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gabaa296d76c28043a60531ad8ed81504b">PORT_DEF_KVTMR_STCK_SIZE</a>&#160;&#160;&#160;40u</td></tr>
<tr class="memdesc:gabaa296d76c28043a60531ad8ed81504b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kernel Virtual Timer Thread stack size.  <a href="#gabaa296d76c28043a60531ad8ed81504b">More...</a><br/></td></tr>
<tr class="separator:gabaa296d76c28043a60531ad8ed81504b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga31d47ffb78c3755575e66821b3a72a62"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga31d47ffb78c3755575e66821b3a72a62">PORT_DEF_KIDLE_STCK_SIZE</a>&#160;&#160;&#160;40u</td></tr>
<tr class="memdesc:ga31d47ffb78c3755575e66821b3a72a62"><td class="mdescLeft">&#160;</td><td class="mdescRight">Kernel Idle Thread stack size.  <a href="#ga31d47ffb78c3755575e66821b3a72a62">More...</a><br/></td></tr>
<tr class="separator:ga31d47ffb78c3755575e66821b3a72a62"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Interrupt management</h2></td></tr>
<tr><td class="ititle" colspan="2"><p><a class="anchor" id="amgrp0762f598cbb5b37886374004ead985d4"></a>PORT_ISR_... macros are used by esKernIsrEnter() and esKernIsrExit() functions. They are used to keep the current level of ISR nesting. Scheduler should be invoked only from the last ISR that is executing. </p>
</td></tr>
<tr class="memitem:gaccad9298c874b29753b318d4f900cb75"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gaccad9298c874b29753b318d4f900cb75">PORT_ISR_ENTER</a>()</td></tr>
<tr class="memdesc:gaccad9298c874b29753b318d4f900cb75"><td class="mdescLeft">&#160;</td><td class="mdescRight">Enter ISR. Increment PortIsrNesting variable to keep track of ISR nesting.  <a href="#gaccad9298c874b29753b318d4f900cb75">More...</a><br/></td></tr>
<tr class="separator:gaccad9298c874b29753b318d4f900cb75"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga267c312d7321e9361b454f4274bbc087"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga267c312d7321e9361b454f4274bbc087">PORT_ISR_EXIT</a>()</td></tr>
<tr class="memdesc:ga267c312d7321e9361b454f4274bbc087"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exit ISR. Decrement PortIsrNesting variable to keep track of ISR nesting.  <a href="#ga267c312d7321e9361b454f4274bbc087">More...</a><br/></td></tr>
<tr class="separator:ga267c312d7321e9361b454f4274bbc087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga6c0ea20c8e1f6b9751f51916da8e2aee"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga6c0ea20c8e1f6b9751f51916da8e2aee">PORT_ISR_IS_LAST</a>()&#160;&#160;&#160;(0u == PortIsrNesting ? TRUE : FALSE)</td></tr>
<tr class="memdesc:ga6c0ea20c8e1f6b9751f51916da8e2aee"><td class="mdescLeft">&#160;</td><td class="mdescRight">If isrNesting variable is zero then the last ISR is executing and scheduler should be invoked.  <a href="#ga6c0ea20c8e1f6b9751f51916da8e2aee">More...</a><br/></td></tr>
<tr class="separator:ga6c0ea20c8e1f6b9751f51916da8e2aee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
Dispatcher context switching</h2></td></tr>
<tr class="memitem:gaa097ec2ead487892969bcd2806539822"><td class="memItemLeft" align="right" valign="top">void *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gaa097ec2ead487892969bcd2806539822">portCtxInit</a> (void *stck, size_t stckSize, void(*fn)(void *), void *arg)</td></tr>
<tr class="memdesc:gaa097ec2ead487892969bcd2806539822"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the thread context.  <a href="#gaa097ec2ead487892969bcd2806539822">More...</a><br/></td></tr>
<tr class="separator:gaa097ec2ead487892969bcd2806539822"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga80d15a56d61c9d4e786e52006ff4ac43"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga80d15a56d61c9d4e786e52006ff4ac43">PORT_CTX_INIT</a>(stck, stackSize, thread, arg)</td></tr>
<tr class="memdesc:ga80d15a56d61c9d4e786e52006ff4ac43"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the thread context.  <a href="#ga80d15a56d61c9d4e786e52006ff4ac43">More...</a><br/></td></tr>
<tr class="separator:ga80d15a56d61c9d4e786e52006ff4ac43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga50a3b72a7f2065922811f0d6dedda01a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga50a3b72a7f2065922811f0d6dedda01a">PORT_CTX_SW</a>()</td></tr>
<tr class="memdesc:ga50a3b72a7f2065922811f0d6dedda01a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do the context switch - invoked from API level.  <a href="#ga50a3b72a7f2065922811f0d6dedda01a">More...</a><br/></td></tr>
<tr class="separator:ga50a3b72a7f2065922811f0d6dedda01a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga20bba8f9c5a2f38fd7c63b9d2320e511"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga20bba8f9c5a2f38fd7c63b9d2320e511">PORT_CTX_SW_ISR</a>()</td></tr>
<tr class="memdesc:ga20bba8f9c5a2f38fd7c63b9d2320e511"><td class="mdescLeft">&#160;</td><td class="mdescRight">Do the context switch - invoked from ISR level.  <a href="#ga20bba8f9c5a2f38fd7c63b9d2320e511">More...</a><br/></td></tr>
<tr class="separator:ga20bba8f9c5a2f38fd7c63b9d2320e511"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga58056289ebeda87723f99f5431c6239e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga58056289ebeda87723f99f5431c6239e">PORT_CTX_SW_START</a>()</td></tr>
<tr class="memdesc:ga58056289ebeda87723f99f5431c6239e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Start the first thread.  <a href="#ga58056289ebeda87723f99f5431c6239e">More...</a><br/></td></tr>
<tr class="separator:ga58056289ebeda87723f99f5431c6239e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="member-group"></a>
General port macros</h2></td></tr>
<tr class="memitem:gabf0ea7d36355a7133ee9e9f8abafa6ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gabf0ea7d36355a7133ee9e9f8abafa6ff">PORT_KCORE_INIT_EARLY</a>()</td></tr>
<tr class="memdesc:gabf0ea7d36355a7133ee9e9f8abafa6ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Early port initialization.  <a href="#gabf0ea7d36355a7133ee9e9f8abafa6ff">More...</a><br/></td></tr>
<tr class="separator:gabf0ea7d36355a7133ee9e9f8abafa6ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga682a913f5439544d4f0ee14ae68507fd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga682a913f5439544d4f0ee14ae68507fd">PORT_KCORE_INIT</a>()</td></tr>
<tr class="memdesc:ga682a913f5439544d4f0ee14ae68507fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Port initialization.  <a href="#ga682a913f5439544d4f0ee14ae68507fd">More...</a><br/></td></tr>
<tr class="separator:ga682a913f5439544d4f0ee14ae68507fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5c133105168261f1744abf3c5917a515"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#ga5c133105168261f1744abf3c5917a515">PORT_KCORE_INIT_LATE</a>()</td></tr>
<tr class="memdesc:ga5c133105168261f1744abf3c5917a515"><td class="mdescLeft">&#160;</td><td class="mdescRight">Late port initialization.  <a href="#ga5c133105168261f1744abf3c5917a515">More...</a><br/></td></tr>
<tr class="separator:ga5c133105168261f1744abf3c5917a515"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gac386e206a8b5225c9aa56be88b625837"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gac386e206a8b5225c9aa56be88b625837">PORT_KCORE_TERM</a>()</td></tr>
<tr class="memdesc:gac386e206a8b5225c9aa56be88b625837"><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminate port.  <a href="#gac386e206a8b5225c9aa56be88b625837">More...</a><br/></td></tr>
<tr class="separator:gac386e206a8b5225c9aa56be88b625837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gacb3a46e89d327fbaf5c122fe23877b24"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gacb3a46e89d327fbaf5c122fe23877b24">PORT_STCK_SIZE</a>(size)&#160;&#160;&#160;(size + <a class="el" href="group__template__cpu__intf.html#ga5a629fee11006b5b0b97f7cb7176efd4">PORT_DEF_STCK_MINSIZE</a>)</td></tr>
<tr class="memdesc:gacb3a46e89d327fbaf5c122fe23877b24"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the stack size.  <a href="#gacb3a46e89d327fbaf5c122fe23877b24">More...</a><br/></td></tr>
<tr class="separator:gacb3a46e89d327fbaf5c122fe23877b24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad699a79233d442ae90a69c113e314542"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__template__cpu__intf.html#gad699a79233d442ae90a69c113e314542">PORT_CRITICAL_EXIT_SLEEP</a>()&#160;&#160;&#160;portIntSetSleepEnter_(intStatus_)</td></tr>
<tr class="memdesc:gad699a79233d442ae90a69c113e314542"><td class="mdescLeft">&#160;</td><td class="mdescRight">Exit critical section and enter sleep state.  <a href="#gad699a79233d442ae90a69c113e314542">More...</a><br/></td></tr>
<tr class="separator:gad699a79233d442ae90a69c113e314542"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p>CPU port macros and functions. </p>
<p>Since this header file is included with the API of the kernel a few naming conventions are defined in order to avoid name clashing with the names of objects from libraries included by application code.</p>
<dl class="section user"><dt>1) Macro naming conventions</dt><dd>For macro naming try to follow these rules:<ul>
<li>All standard PORT API macro names are prefixed with: <b><code>PORT_</code>.</b> </li>
<li>All other macros which are specific to the port used are prefixed with: <b><code>CPU_</code>.</b> </li>
</ul>
</dd></dl>
<dl class="section user"><dt>2) Type declaration naming conventions</dt><dd>For type declaration naming try to follow these rules:<ul>
<li>All type declaration names are prefixed with: <b><code>port</code>.</b> </li>
</ul>
</dd></dl>
<dl class="section user"><dt>3) Global variable naming conventions</dt><dd>For global variable naming try to follow these rules:<ul>
<li>All global variable names are prefixed with: <b><code>Port</code>.</b> </li>
</ul>
</dd></dl>
<dl class="section user"><dt>4) Function naming conventions</dt><dd>For functions naming try to follow these rules:<ul>
<li>All standard PORT API function names are prefixed with: <b><code>port</code></b>.</li>
<li>All other functions which are specific to the port used are prefixed with: <b><code>cpu</code></b></li>
<li>All inline functions are additionally postfixed with: <b><code>_</code> </b>(underscore).</li>
<li>The <code>exception</code> to above two rules are the names of functions used for Interrupt Service Routines. They can have any name required by the port. </li>
</ul>
</dd></dl>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="ga5a629fee11006b5b0b97f7cb7176efd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_DEF_STCK_MINSIZE&#160;&#160;&#160;(sizeof(struct <a class="el" href="structportCtx.html">portCtx</a>) / sizeof(portReg_T))</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This macro specifies the minimal size of the thread stack. </p>
<p>Generally minimal stack size is equal to the size of context structure </p>

</div>
</div>
<a class="anchor" id="ga96e15dd16b285b0feb6e225b0834ad10"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_DEF_SYSTMR_WAKEUP_TH_VAL&#160;&#160;&#160;600u</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Threshold system timer value for new tick. </p>

</div>
</div>
<a class="anchor" id="gabaa296d76c28043a60531ad8ed81504b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_DEF_KVTMR_STCK_SIZE&#160;&#160;&#160;40u</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kernel Virtual Timer Thread stack size. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>This value needs tweaking </dd></dl>

</div>
</div>
<a class="anchor" id="ga31d47ffb78c3755575e66821b3a72a62"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_DEF_KIDLE_STCK_SIZE&#160;&#160;&#160;40u</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Kernel Idle Thread stack size. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000002">Todo:</a></b></dt><dd>This value needs tweaking </dd></dl>

</div>
</div>
<a class="anchor" id="gaccad9298c874b29753b318d4f900cb75"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_ISR_ENTER</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                                                        <a class="code" href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">\</a></div>
<div class="line"><a class="code" href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">        PortIsrNesting</a>++;                                                       <a class="code" href="group__kern__general.html#gac0d578bcd4a10b2c8e5fc90f0b86ccec">\</a></div>
<div class="line"><a class="code" href="group__kern__general.html#gac0d578bcd4a10b2c8e5fc90f0b86ccec">        esKernIsrEnterI</a>();                                                      \</div>
<div class="line">    } <span class="keywordflow">while</span> (0u)</div>
<div class="ttc" id="group__kern__general_html_gac0d578bcd4a10b2c8e5fc90f0b86ccec"><div class="ttname"><a href="group__kern__general.html#gac0d578bcd4a10b2c8e5fc90f0b86ccec">esKernIsrEnterI</a></div><div class="ttdeci">void esKernIsrEnterI(void)</div><div class="ttdoc">Enter Interrupt Service Routine. </div><div class="ttdef"><b>Definition:</b> kernel.c:1053</div></div>
<div class="ttc" id="group__template__cpu__intf_html_gab0ad3c664e66a9a334daa4109c14e585"><div class="ttname"><a href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">PortIsrNesting</a></div><div class="ttdeci">portReg_T PortIsrNesting</div><div class="ttdoc">Variable to keep track of ISR nesting. </div></div>
</div><!-- fragment -->
<p>Enter ISR. Increment PortIsrNesting variable to keep track of ISR nesting. </p>
<p>Variable PortIsrNesting is needed only if the port does not support any other method of detecting when the last ISR is executing. </p>

</div>
</div>
<a class="anchor" id="ga267c312d7321e9361b454f4274bbc087"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_ISR_EXIT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> {                                                                        <a class="code" href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">\</a></div>
<div class="line"><a class="code" href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">        PortIsrNesting</a>--;                                                       <a class="code" href="group__kern__general.html#gaa6347925fff1684b5425dd2857c27129">\</a></div>
<div class="line"><a class="code" href="group__kern__general.html#gaa6347925fff1684b5425dd2857c27129">        esKernIsrExitI</a>();                                                       \</div>
<div class="line">    } <span class="keywordflow">while</span> (0u)</div>
<div class="ttc" id="group__template__cpu__intf_html_gab0ad3c664e66a9a334daa4109c14e585"><div class="ttname"><a href="group__template__cpu__intf.html#gab0ad3c664e66a9a334daa4109c14e585">PortIsrNesting</a></div><div class="ttdeci">portReg_T PortIsrNesting</div><div class="ttdoc">Variable to keep track of ISR nesting. </div></div>
<div class="ttc" id="group__kern__general_html_gaa6347925fff1684b5425dd2857c27129"><div class="ttname"><a href="group__kern__general.html#gaa6347925fff1684b5425dd2857c27129">esKernIsrExitI</a></div><div class="ttdeci">void esKernIsrExitI(void)</div><div class="ttdoc">Exit Interrupt Service Routine. </div><div class="ttdef"><b>Definition:</b> kernel.c:1061</div></div>
</div><!-- fragment -->
<p>Exit ISR. Decrement PortIsrNesting variable to keep track of ISR nesting. </p>
<p>Variable PortIsrNesting is needed only if the port does not support any other method of detecting when the last ISR is executing. </p>

</div>
</div>
<a class="anchor" id="ga6c0ea20c8e1f6b9751f51916da8e2aee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_ISR_IS_LAST</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;(0u == PortIsrNesting ? TRUE : FALSE)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If isrNesting variable is zero then the last ISR is executing and scheduler should be invoked. </p>
<dl class="section return"><dt>Returns</dt><dd>Is the currently executed ISR the last one? </dd></dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">TRUE</td><td>- this is last ISR </td></tr>
    <tr><td class="paramname">FALSE</td><td>- this is not the last ISR </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga80d15a56d61c9d4e786e52006ff4ac43"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_CTX_INIT</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stck, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">stackSize, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">thread, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">arg&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the thread context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">stck</td><td>Pointer to the allocated thread stack. The pointer points to the beginning of the memory as defined per C language. It's up to port function to adjust the pointer according to the stack type: full descending or full ascending one. </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">stackSize</td><td>The size of allocated stack in bytes. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">thread</td><td>Pointer to the thread function. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>Argument that will be passed to thread function at the starting of execution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new top of stack after thread context initialization. </dd></dl>

</div>
</div>
<a class="anchor" id="ga50a3b72a7f2065922811f0d6dedda01a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_CTX_SW</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do the context switch - invoked from API level. </p>

</div>
</div>
<a class="anchor" id="ga20bba8f9c5a2f38fd7c63b9d2320e511"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_CTX_SW_ISR</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Do the context switch - invoked from ISR level. </p>

</div>
</div>
<a class="anchor" id="ga58056289ebeda87723f99f5431c6239e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_CTX_SW_START</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Start the first thread. </p>

</div>
</div>
<a class="anchor" id="gabf0ea7d36355a7133ee9e9f8abafa6ff"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KCORE_INIT_EARLY</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Early port initialization. </p>
<p>This macro will be called at early initialization stage from <a class="el" href="group__kern__general.html#ga9e9ff699d62d6035cd51121bb3140704" title="Initialize kernel internal data structures. ">esKernInit()</a> function. It is called before any kernel data initialization. Usually this macro would be used to setup memory space, fill the memory with debug value or something similar. </p>

</div>
</div>
<a class="anchor" id="ga682a913f5439544d4f0ee14ae68507fd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KCORE_INIT</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Port initialization. </p>
<p>This macro will be called after kernel data structure initialization from <a class="el" href="group__kern__general.html#ga9e9ff699d62d6035cd51121bb3140704" title="Initialize kernel internal data structures. ">esKernInit()</a> function. </p>

</div>
</div>
<a class="anchor" id="ga5c133105168261f1744abf3c5917a515"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KCORE_INIT_LATE</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Late port initialization. </p>
<p>This macro will be called just a moment before the multitasking is started. The macro is called from <a class="el" href="group__kern__general.html#ga0e7a0a6b9c02df58de0f98de0229a09d" title="Start the multi-threading. ">esKernStart()</a> function. </p>

</div>
</div>
<a class="anchor" id="gac386e206a8b5225c9aa56be88b625837"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_KCORE_TERM</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Terminate port. </p>
<p>This macro will be called when there is a need to stop any further execution (example: an error occurred and CPU needs to stop). </p>

</div>
</div>
<a class="anchor" id="gacb3a46e89d327fbaf5c122fe23877b24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_STCK_SIZE</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">size</td><td>)</td>
          <td>&#160;&#160;&#160;(size + <a class="el" href="group__template__cpu__intf.html#ga5a629fee11006b5b0b97f7cb7176efd4">PORT_DEF_STCK_MINSIZE</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the stack size. </p>
<p>This macro is used when specifying the size of thread stack. Responsibility:</p>
<ul>
<li>add to <code>size</code> the minimal stack size specified by <code>PORT_DEF_DATA_WIDTH</code> macro.</li>
<li>if it is needed by the port make sure the alignment is correct. </li>
</ul>

</div>
</div>
<a class="anchor" id="gad699a79233d442ae90a69c113e314542"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PORT_CRITICAL_EXIT_SLEEP</td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td>&#160;&#160;&#160;portIntSetSleepEnter_(intStatus_)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Exit critical section and enter sleep state. </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="ga13cc91970e3e05fe4210440c068d3f4a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structportStck.html">portStck</a> <a class="el" href="group__template__cpu__intf.html#ga13cc91970e3e05fe4210440c068d3f4a">portStck_T</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Stack type. </p>
<p>Stack type </p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gaa097ec2ead487892969bcd2806539822"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* portCtxInit </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>stck</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>stckSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void(*)(void *)&#160;</td>
          <td class="paramname"><em>fn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the thread context. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">stck</td><td>Pointer to the allocated thread stack. The pointer points to the beginning of the memory as defined per C language. It's up to port function to adjust the pointer according to the stack type: full descending or full ascending one. </td></tr>
    <tr><td class="paramname">stckSize</td><td>The size of allocated stack in bytes. </td></tr>
    <tr><td class="paramname">fn</td><td>Pointer to the thread function. </td></tr>
    <tr><td class="paramname">arg</td><td>Argument that will be passed to thread function at the starting of execution. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The new top of stack after thread context initialization. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="gab0ad3c664e66a9a334daa4109c14e585"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">portReg_T PortIsrNesting</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Variable to keep track of ISR nesting. </p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.5 </li>
  </ul>
</div>
</body>
</html>
